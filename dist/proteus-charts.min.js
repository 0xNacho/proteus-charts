"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},utils=utils||{isArray:function(e){return e&&e.constructor===Array&&e instanceof Array},isObject:function(e){return e&&e.constructor===Object&&e instanceof Object},isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isPercentage:function(e){var t=null,n=null;return e&&"string"==typeof e?(t=e.split("%"),n=+t[0],2===t.length&&n>=0&&100>=n):!1},keys:function e(t,n){var e=new Set,r=null;if(!t||!t.length)return[];for(var a=0;a<t.length;a++)r=n?t[a][n]:t[a],r&&e.add(r);return e},getNumberOfDifferentArrayKeys:function(e,t){var n=[],r=null;if(!e||!e.length)return 0;for(var a=0;a<e.length;a++)r=t?e[a][t]:e[a],r&&n.push(r);return d3.set(n).size()},sortBy:function(e,t){var n=Object.prototype.toString,r=function(e){return e},a=function(e){return r(null!==e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))&&e[t.prop]||e)};return e instanceof Array&&e.length?("[object Object]"!==n.call(t)&&(t={}),"function"!=typeof t.parser&&(t.parser=r),t.desc=t.desc?-1:1,e.sort(function(e,n){return e=a.call(t,e),n=a.call(t,n),t.desc*(n>e?-1:+(e>n))})):[]},findElement:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t]===n)return e[r];return null},deg2rad:function(e){return e*Math.PI/180}};Set.prototype.equals=function(e){if(e.size!==this.size)return!1;var t=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;if(!this.has(o))return!1}}catch(s){n=!0,r=s}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}return!0};var utils=utils||{},doctype='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">';!function(){function e(e){return e&&0===e.lastIndexOf("http",0)&&-1===e.lastIndexOf(window.location.host)}function t(t,n){var r=t.querySelectorAll("image"),a=r.length;0===a&&n();for(var i=0;i<r.length;i++)!function(t){var r=t.getAttribute("xlink:href");if(r&&e(r.value))return void console.warn("Cannot render embedded images linking to external hosts: "+r.value);var i=document.createElement("canvas"),o=i.getContext("2d"),s=new Image;r=r||t.getAttribute("href"),s.src=r,s.onload=function(){i.width=s.width,i.height=s.height,o.drawImage(s,0,0),t.setAttribute("xlink:href",i.toDataURL("image/png")),a--,0===a&&n()},s.onerror=function(){console.error("Could not load "+r),a--,0===a&&n()}}(r[i])}function n(t,n){for(var r="",a=document.styleSheets,i=0;i<a.length;i++)if(e(a[i].href))console.warn("Cannot include styles from other hosts: "+a[i].href);else{var o=a[i].cssRules;if(null!==o)for(var s=0;s<o.length;s++){var l=o[s];if("undefined"!=typeof l.style){var c=null;try{c=t.querySelector(l.selectorText)}catch(u){console.warn('Invalid CSS selector "'+l.selectorText+'"',u)}if(c){var f=n?n(l.selectorText):l.selectorText;r+=f+" { "+l.style.cssText+" }\n"}else l.cssText.match(/^@font-face/)&&(r+=l.cssText+"\n")}}}return r}utils.svgAsDataUri=function(e,r,a){r=r||{},r.scale=r.scale||1;var i="http://www.w3.org/2000/xmlns/";t(e,function(){var t,o,s=document.createElement("div"),l=e.cloneNode(!0);if("svg"===e.tagName)t=parseInt(l.getAttribute("width")||l.style.width||getComputedStyle(e).getPropertyValue("width")),o=parseInt(l.getAttribute("height")||l.style.height||getComputedStyle(e).getPropertyValue("height"));else{var c=e.getBBox();t=c.x+c.width,o=c.y+c.height,l.setAttribute("transform",l.getAttribute("transform").replace(/translate\(.*?\)/,""));var u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.appendChild(l),l=u}l.setAttribute("version","1.1"),l.setAttributeNS(i,"xmlns","http://www.w3.org/2000/svg"),l.setAttributeNS(i,"xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttribute("width",t*r.scale),l.setAttribute("height",o*r.scale),l.setAttribute("viewBox","0 0 "+t+" "+o),s.appendChild(l);var f=n(e,r.selectorRemap),h=document.createElement("style");h.setAttribute("type","text/css"),h.innerHTML="<![CDATA[\n"+f+"\n]]>";var d=document.createElement("defs");d.appendChild(h),l.insertBefore(d,l.firstChild);var u=doctype+s.innerHTML,p="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(u)));a&&a(p)})}}();var strategies={Barchart:function(e){return new SvgBarchartStrategy(e)},Linechart:function(e){return new SvgLinechartStrategy(e)},Streamgraph:function(e){return new SvgStreamgraphStrategy(e)},Gauge:function(e){return new SvgGaugeStrategy(e)}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Colors=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"category1",value:function(){return d3.scale.ordinal().range(paletteCategory1)}},{key:"category2",value:function(){return d3.scale.ordinal().range(paletteCategory2)}},{key:"category3",value:function(){return d3.scale.ordinal().range(paletteCategory3)}},{key:"category4",value:function(){return d3.scale.ordinal().range(paletteCategory4)}},{key:"category5",value:function(){return d3.scale.ordinal().range(paletteCategory5)}},{key:"category6",value:function(){return d3.scale.ordinal().range(paletteCategory6)}},{key:"category7",value:function(){return d3.scale.ordinal().range(paletteCategory7)}},{key:"category8",value:function(){return d3.scale.ordinal().range(paletteCategory8)}},{key:"sequentialYellow",value:function(){return d3.scale.quantile().range(paletteSequentialYellow)}},{key:"sequentialRedOrange",value:function(){return d3.scale.quantile().range(paletteSequentialRedOrange)}},{key:"sequentialRed",value:function(){return d3.scale.quantile().range(paletteSequentialRed)}},{key:"sequentialPink",value:function(){return d3.scale.quantile().range(paletteSequentialPink)}},{key:"sequentialPurplePink",value:function(){return d3.scale.quantile().range(paletteSequentialPurplePink)}},{key:"sequentialPurple",value:function(){return d3.scale.quantile().range(paletteSequentialPurple)}},{key:"sequentialBlue",value:function(){return d3.scale.quantile().range(paletteSequentialBlue)}},{key:"sequentialLightBlue",value:function(){return d3.scale.quantile().range(paletteSequentialLightBlue)}},{key:"sequentialBlueViolet",value:function(){return d3.scale.quantile().range(paletteSequentialBlueViolet)}},{key:"sequentialTurquoise",value:function(){return d3.scale.quantile().range(paletteSequentialTurquoise)}},{key:"sequentialLightGreen",value:function(){return d3.scale.quantile().range(paletteSequentialLightGreen)}},{key:"sequentialDarkGreen",value:function(){return d3.scale.quantile().range(paletteSequentialDarkGreen)}},{key:"sequentialGreenBrown",value:function(){return d3.scale.quantile().range(paletteSequentialGreenBrown)}},{key:"sequentialBrown",value:function(){return d3.scale.quantile().range(paletteSequentialBrown)}},{key:"sequentialGrey",value:function(){return d3.scale.quantile().range(paletteSequentialGrey)}},{key:"sequentialVioletCb",value:function(){return d3.scale.quantile().range(paletteSequentialVioletCb)}},{key:"sequentialPinkCb",value:function(){return d3.scale.quantile().range(paletteSequentialPinkCb)}},{key:"sequentialBlueCb",value:function(){return d3.scale.quantile().range(paletteSequentialBlueCb)}},{key:"sequentialGreenCb",value:function(){return d3.scale.quantile().range(paletteSequentialGreenCb)}},{key:"sequentialGreenBrownCb",value:function(){return d3.scale.quantile().range(paletteSequentialGreenBrownCb)}},{key:"diverging_spectral1",value:function(){return d3.scale.quantile().range(paletteDivergingSpectral1)}},{key:"diverging_spectral2",value:function(){return d3.scale.quantile().range(paletteDivergingSpectral2)}},{key:"diverging_spectral3",value:function(){return d3.scale.quantile().range(paletteDivergingSpectral3)}},{key:"diverging_brown_turquoise",value:function(){return d3.scale.quantile().range(paletteDivergingBrownTurquoise)}},{key:"diverging_orange_pink",value:function(){return d3.scale.quantile().range(paletteDivergingBrownTurquoise)}},{key:"diverging_red_blue",value:function(){return d3.scale.quantile().range(paletteDivergingRedBlue)}},{key:"diverging_red_grey",value:function(){return d3.scale.quantile().range(paletteDivergingRedGrey)}},{key:"diverging_orange_violet",value:function(){return d3.scale.quantile().range(paletteDivergingOrangeViolet)}},{key:"diverging_purple_green",value:function(){return d3.scale.quantile().range(paletteDivergingPurpleGreen)}},{key:"diverging_violet_green",value:function(){return d3.scale.quantile().range(paletteDivergingVioletGreen)}},{key:"diverging_red_green",value:function(){return d3.scale.quantile().range(paletteDivergingRedGreen)}},{key:"diverging_brown_green",value:function(){return d3.scale.quantile().range(paletteDivergingBrownGreen)}},{key:"diverging_lightBrown_turquoise",value:function(){return d3.scale.quantile().range(palette_divergingLightBrownTurquoise)}}]),e}(),paletteCategory1=["#e1c8df","#9ecd9d","#acd9d6","#e4e36b","#bfa1c5","#e4d3b8","#facba8","#ced4ea","#acd9d6"],paletteCategory2=["#b6dde2","#6394af","#e4e9ab","#8ea876","#f7dce1","#cc878f","#fadaac","#f29a83","#8d7e9e"],paletteCategory3=["#6b68a9","#8cc590","#b9487d","#bfa1c5","#4e6936","#71bbc3","#484156","#ccaf44","#d0553c"],paletteCategory4=["#f1a30d","#1d4763","#84c7bc","#c1212d","#8fbe46","#076837","#563a2d","#563a2d","#87325d"],paletteCategory5=["#f1a30d","#0c3183","#acd9d6","#c1212d","#8fbe46","#076837","#8a6338","#8d2d84","#f09bbc"],paletteCategory6=["#71bbc3","#1d4763","#8fbe46","#4e6936","#ee8998","#c1212d","#f5af3c","#e95e2e","#634484"],paletteCategory7=["#ea671e","#684592","#84b92a","#cd131c","#3c5ba2","#5baddc","#ffde06","#5db68b","#775e47"],paletteCategory8=["#ebd646","#a50f38","#00a096","#f09bbc","#065b78","#72722a","#005231","#4d4e98","#7c4d25"],paletteSequentialYellow=["#fff1c6","#fee5a7","#fcda87","#face64","#f8bf4b","#f6b030","#f4a009","#d28514","#b36c17","#955618","#7a4317","#613214","#49230f"],paletteSequentialRedOrange=["#ffecb8","#fbd68b","#f7bf5e","#f3a82f","#df7520","#cd4925","#be0a26","#a81023","#941320","#80141d","#6d1419","#5a1215","#470f0f"],paletteSequentialRed=["#fde4d4","#f1c4af","#f7bf5e","#db826a","#d0614d","#c73e36","#be0a26","#a81023","#941320","#80141d","#6d1419","#5a1215","#470f0f"],paletteSequentialPink=["#fbe3e3","#f9cfcc","#f0aaa9","#ed7e7e","#ea647b","#e74576","#e41270","#c70f65","#aa105c","#8d1253","#731448","#5a123c","#420e30"],paletteSequentialPurplePink=["#f9d8e6","#ebbed7","#dda4c7","#c890bb","#b27daf","#8a4c94","#622181","#622181","#50216b","#472060","#3e1f55","#361e4b","#2d1c41"],paletteSequentialPurple=["#f6e8f1","#dcc5de","#c2a3c9","#a980b3","#905e9f","#793f8e","#622181","#592175","#4f216b","#462060","#3d1f55","#351e4b","#2c1c41"],paletteSequentialBlue=["#e5f2f9","#d1e5f5","#afd3ed","#91afd7","#738bbf","#3c5a9e","#0c3183","#132a68","#10204c","#0b193b","#06142f","#051228","#061020"],paletteSequentialLightBlue=["#eff8fd","#d9eff6","#c2e5ef","#a8dae8","#90cbe4","#76b8e1","#5baddc","#4d96cc","#427ebc","#3a67ab","#324c88","#29366b","#1e2354"],paletteSequentialBlueViolet=["#edf7e7","#c8e3d2","#91cdbf","#41b5ab","#218ba4","#145d94","#0c3183","#0d2d76","#0d2a6a","#0e265e","#0d2253","#0c1e47","#0b1a3c"],paletteSequentialTurquoise=["#e2ecf6","#cadfe6","#b1d3d6","#94c6c6","#74b9b6","#4caca6","#00a096","#008d89","#007b7c","#006a6f","#005963","#004a57","#063b4c"],paletteSequentialLightGreen=["#faf9de","#e9efc3","#d7e4a7","#c5d989","#b1ce6a","#9cc34c","#84b92a","#6fa32b","#5a8f2a","#477c29","#346b27","#205b24","#074d21"],paletteSequentialDarkGreen=["#eaf3e5","#c7d5be","#a3ba9a","#80a078","#5c885a","#357442","#00632e","#00592b","#004e27","#004423","#033a1e","#053019","#052613"],paletteSequentialGreenBrown=["#f7eccd","#d9cba6","#bcad82","#a29162","#887946","#716330","#5b501f","#51461d","#483d1b","#3f3418","#362b15","#2d2311","#231a0d"],paletteSequentialBrown=["#f7eccd","#eed3ab","#e4bb89","#dba269","#ad7446","#834d2c","#5e2f19","#552a18","#4c2516","#432113","#3a1c11","#32180f","#29130b"],paletteSequentialGrey=["#e5e8ea","#bdbfc3","#999a9f","#77797f","#595c64","#3e444c","#253038","#20282e","#1a2024","#15181b","#0e1112","#070808","#000000"],paletteSequentialVioletCb=["#f4f3f9","#e0dced","#cbc6e0","#b7b0d4","#948cbf","#706baa","#4d4e98","#484889","#42427a","#3d3c6c","#37365e","#313050","#2c2a44"],paletteSequentialPinkCb=["#fbe5ee","#f8ccd5","#f4b2bc","#f096a3","#d56976","#bc3f52","#a50f38","#951735","#851b31","#761d2e","#671e2a","#581d26","#4a1c22"],paletteSequentialBlueCb=["#eaf6fc","#cfe4f4","#cfe4f4","#91bfe3","#6999bb","#417797","#065b78","#11536b","#174b5f","#194354","#1a3b49","#1a343f","#192d35"],paletteSequentialGreenCb=["#fff7d0","#e9e09b","#d1ca62","#b7b623","#9e9e28","#88872a","#72722a","#676726","#5c5c23","#51511f","#47471b","#3d3d17","#333413"],paletteSequentialGreenBrownCb=["#f2edde","#d8d1c0","#bfb699","#a09778","#837b5a","#686141","#4f4b2c","#3e3e1f","#2e3313","#292d14","#232613","#1e2012","#191a10"],paletteDivergingSpectral1=["#98141f","#ab332c","#bf5040","#d5705b","#e4a57f","#f3d6a6","#f5f2b8","#cfdbb1","#a4c4a9","#71ada1","#4e868f","#2e637d","#06456c"],paletteDivergingSpectral2=["#d43d4f","#df564b","#eb6d45","#f08e53","#f8b96f","#fee08b","#f5f2b8","#d7e5b1","#b5d7aa","#8ec8a3","#6abda3","#4fa4b5","#3489be"],paletteDivergingSpectral3=["#651035","#ae1143","#c9314b","#dd7257","#eeb27a","#feeb9e","#f5f2b8","#cadfba","#96cabb","#50b4bb","#3eaecc","#206791","#0c2c63"],paletteDivergingBrownTurquoise=["#3f3128","#683828","#933624","#d5705b","#db9c5e","#feeb9e","#f5f2b8","#cfdbb1","#a4c4a9","#71ada1","#628f85","#53746d","#475b57"],paletteDivergingOrangePink=["#e7511e","#eb6929","#ee7f37","#f29446","#f9c083","#ffe9c3","#ffeee3","#f9cfc1","#f3a9ab","#db6882","#c71360","#891953","#4b1c47"],paletteDivergingRedBlue=["#b2172b","#c4443e","#d76a5a","#ed937e","#f4b8a2","#fcdbc7","#efefef","#bfcad5","#8ba7bc","#4d87a5","#3c7ca0","#28729b","#036896"],paletteDivergingRedGrey=["#b2172b","#c54532","#da6c3b","#f29446","#f8bc67","#fee08b","#efece5","#c9c5c1","#a5a19f","#808080","#666666","#333333","#000000"],paletteDivergingOrangeViolet=["#98141f","#ab332c","#f9bc47","#fdcf66","#fede8d","#ffecb3","#f9eff6","#e8d0e3","#a4c4a9","#a973aa","#834f96","#622181","#402357"],paletteDivergingPurpleGreen=["#59194b","#85134b","#c71360","#db6882","#eba7a8","#fce0ca","#faefe1","#dbd9aa","#b9c26e","#94ad31","#728b2b","#546c25","#39521f"],paletteDivergingVioletGreen=["#55296e","#75408e","#8a5fa0","#a081b5","#beadcf","#ddd7e7","#eae8ed","#c1d4bc","#93be86","#58a951","#3c853e","#23662f","#084a22"],paletteDivergingRedGreen=["#b2172b","#c5403c","#d96453","#ef8972","#f6b49c","#fcdbc7","#f9ebde","#dad6a8","#b9c16d","#94ad31","#728b2b","#546c25","#39521f"],paletteDivergingBrownGreen=["#735146","#846454","#977a65","#aa9177","#c2ad91","#dbcaad","#edebd6","#c4d6aa","#94bf7c","#58a951","#3c853e","#23662f","#084a22"],palette_divergingLightBrownTurquoise=["#8b5219","#a46821","#bf812c","#cfa151","#e2c489","#f6e8c3","#f5f1df","#cbdccc","#9cc6b9","#60afa6","#359790","#1d7d75","#00665e"],_default={Barchart:{style:{".axis":{font:"10px sans-serif"},".axis path,.axis line":{fill:"none",stroke:"#000","shape-rendering":"crispEdges"},".x.axis path":{display:"none"},".x.axis.label, .y.axis.label":{font:"12px sans-serif"}},xaxis:{label:""},yaxis:{label:"Y"},colorScale:Colors.category7(),margin:{top:20,right:20,bottom:30,left:50},width:"100%",height:350,ticks:5,tooltip:function(e){return"<b>Eje x</b>: "+e.x+"<br/><b>Eje y</b>: "+e.y},tickLabel:"",selector:"#chart",events:{down:function(){d3.select(this).classed("hover",!1)},over:function(){d3.select(this).transition().duration(150).attr("fill-opacity",.4)},leave:function(){d3.select(this).transition().duration(150).attr("fill-opacity",1)},click:function(e,t){console.log(e,t)}},transitionDuration:300,maxNumberOfElements:0,sortData:{descending:!1,prop:"x"}},Linechart:{selector:"#chart",xaxis:{label:"X",ticks:5},yaxis:{label:"Y",ticks:5},colorScale:Colors.category7(),area:!1,areaOpacity:.4,margin:{top:20,right:20,bottom:30,left:50},width:"100%",height:250,style:{".line":{"stroke-width":2,fill:"none"},".area":{"stroke-width":0},".axis":{font:"10px sans-serif"},".axis path,.axis line":{fill:"none",stroke:"#000","shape-rendering":"crispEdge"},".x.axis path":{display:"none"},".x.axis.label, .y.axis.label":{font:"12px sans-serif"}},markers:{shape:"circle",size:5,color:"#FFFCCA",outlineColor:"#537780",outlineWidth:2},tooltip:function(e){return JSON.stringify(e)},events:{down:function(){d3.select(this).classed("hover",!1)},over:function(){d3.select(this).transition().duration(50).attr("r",7)},leave:function(){d3.select(this).transition().duration(50).attr("r",5).style("stroke-width",2)},click:function(e,t){console.log(e,t)}},tickLabel:"",transitionDuration:300,maxNumberOfElements:10,sortData:{descending:!1,prop:"x"}},Streamgraph:{selector:"#chart",xDateFormat:"%m/%d/%y",colorScale:Colors.category5(),xaxis:{label:""},yaxis:{label:""},style:{".axis":{font:"10px sans-serif"},".axis path,.axis line":{fill:"none",stroke:"#000","shape-rendering":"crispEdges"},".x.axis path":{display:"none"},".x.axis.label, .y.axis.label":{font:"12px sans-serif"}},margin:{top:20,right:20,bottom:30,left:50},width:"100%",height:300,ticks:5,tooltip:function(e){return"Info: "+JSON.stringify(e)},tickLabel:"",events:{down:function(){d3.select(this).classed("hover",!1)},over:function(){d3.select(this).transition().duration(150).attr("fill-opacity",.4)},leave:function(){d3.select(this).transition().duration(150).attr("fill-opacity",1)},click:function(e,t){console.log(e,t)}},transitionDuration:300,maxNumberOfElements:0,sortData:{descending:!1,prop:"x"}},Gauge:{selector:"#chart",colorScale:Colors.diverging_red_blue(),invertColorScale:!0,minLevel:0,maxLevel:100,minAngle:-90,maxAngle:180,ringWidth:50,ringMargin:20,labelInset:10,needleNutRadius:25,needleLenghtRatio:.8,numericIndicator:!0,xaxis:{label:"X"},yaxis:{label:"Y"},margin:{top:20,right:20,bottom:30,left:50},width:"50%",height:250,style:{".labels":{font:"18px sans-serif","text-anchor":"middle"},".text-indicator":{font:"48px sans-serif","text-anchor":"middle"},".needle":{fill:"#666666"}},ticks:10,markers:{shape:"circle",size:5,color:"#FFFCCA",outlineColor:"#537780",outlineWidth:2},tooltip:function(e){return JSON.stringify(e)},events:{down:function(){d3.select(this).classed("hover",!1)},over:function(){d3.select(this).transition().duration(50).attr("r",7)},leave:function(){d3.select(this).transition().duration(50).attr("r",5).style("stroke-width",2)},click:function(e,t){console.log(e,t)}},tickLabel:"",transitionDuration:300,maxNumberOfElements:5,sortData:{descending:!1,prop:"x"}}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ProteusEvent=function(){function e(t){_classCallCheck(this,e),this.name=t,this.callbacks=[]}return _createClass(e,[{key:"registerCallback",value:function(e){this.callbacks.push(e)}}]),e}(),Reactor=function(){function e(){_classCallCheck(this,e),this.events={}}return _createClass(e,[{key:"registerEvent",value:function(e){var t=new ProteusEvent(e);this.events[e]=t}},{key:"dispatchEvent",value:function(e,t){this.events[e]&&this.events[e].callbacks.forEach(function(e){e(t)})}},{key:"addEventListener",value:function(e,t){this.events[e]&&this.events[e].registerCallback(t)}},{key:"removeEventListener",value:function(e){var t=this.events[e];t.callbacks=[]}}]),e}(),Datasource=function t(){_classCallCheck(this,t)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),WebsocketDatasource=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return n.source=e,n.reactors=[],n}return _inherits(t,e),_createClass(t,[{key:"configure",value:function(e){this.reactors.push(e)}},{key:"start",value:function(){var e=this;this.ws=new WebSocket(this.source.endpoint),this.ws.onopen=function(t){for(var n in e.reactors){var r=e.reactors[n];r.dispatchEvent("onopen",t)}},this.ws.onerror=function(t){for(var n in e.reactors){var r=e.reactors[n];r.dispatchEvent("onerror",t)}},this.ws.onmessage=function(t){var n=JSON.parse(event.data.substr(2))[1];for(var r in e.reactors){var a=e.reactors[r];a.dispatchEvent("onmessage",n)}}}},{key:"stop",value:function(){this.ws&&this.ws.close()}}]),t}(Datasource),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),SvgStrategy=function(){function e(t){_classCallCheck(this,e),this.strategy=t}return _createClass(e,[{key:"draw",value:function(e){this.strategy.draw(e)}},{key:"on",value:function(e){this.strategy.on(e)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),SvgChart=function(){function e(t){_classCallCheck(this,e);var n=this.constructor.name;if("SvgChart"===n)throw new Error(n+" is non-instanciable");this._initialized=!1,this.cType=t.cType,this._loadConfigOnContext(t.config),this.interactiveElements=null}return _createClass(e,[{key:"draw",value:function(e){this._sortData&&utils.sortBy(e,{prop:this._sortData.prop,desc:this._sortData.descending}),this._initialized||this._initialize()}},{key:"_initialize",value:function(){var e=this.width+this.margin.left+this.margin.right,t=this.height+this.margin.left+this.margin.right;this.svg=d3.select(this.selector).append("svg").attr({width:e,height:t}).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.tip&&(this.tooltip=d3.tip().attr("class","d3-tip").style({"line-height":1,padding:"12px",background:"rgba(0, 0, 0, 0.8)",color:"#fff","border-radius":"2px","pointer-events":"none"}).html(this.tip),this.svg.call(this.tooltip)),this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis),this.svg.append("g").attr("class","y axis").attr("stroke-dasharray","1, 2").call(this.yAxis).append("text"),this.svg.append("text").attr("text-anchor","middle").attr("class","x axis label").attr("x",this.width/2).attr("y",this.height+this.margin.bottom).text(this.xAxisLabel),this.svg.append("text").attr("text-anchor","middle").attr("class","y axis label").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",-this.margin.left/1.3).text(this.yAxisLabel)}},{key:"_applyCSS",value:function(){var e=this.style,t=null;for(var n in e)t=e[n],d3.selectAll(n).style(t)}},{key:"on",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];for(var t in e){var n=e[t];this.interactiveElements.on(t+".user",n)}}},{key:"_calculateWidth",value:function(e){if("auto"===e)return d3.select(this.selector).node().getBoundingClientRect().width;if(utils.isNumeric(e))return e;if(utils.isPercentage(e)){var t=void 0,n=void 0;return t=d3.select(this.selector).node().getBoundingClientRect().width,n=e.split("%")[0],Math.round(n*t/100)}throw Error("Unknow chart width: "+e)}},{key:"_loadConfigOnContext",value:function(e){e=e||{events:{},markers:{},xaxis:{},yaxis:{}},e.events||(e.events={}),e.markers||(e.markers={}),e.xaxis||(e.xaxis={}),e.yaxis||(e.yaxis={}),this.selector=e.selector||_default[this.cType].selector,this.margin=e.margin||_default[this.cType].margin,this.width=e.width?this._calculateWidth(e.width)-this.margin.left-this.margin.right:this._calculateWidth(_default[this.cType].width)-this.margin.left-this.margin.right,this.height=e.height||_default[this.cType].height,this.ticks=e.ticks||_default[this.cType].ticks,this.xticks=e.xaxis.ticks||_default[this.cType].xaxis.ticks,this.yticks=e.yaxis.ticks||_default[this.cType].yaxis.ticks,this.tickLabel=e.tickLabel||_default[this.cType].tickLabel,this.transitionDuration=e.transitionDuration||_default[this.cType].transitionDuration,this.tip=e.tooltip||_default[this.cType].tooltip,this.events={},this.events.down=e.events.down||_default[this.cType].events.down,this.events.up=e.events.up||_default[this.cType].events.up,this.events.over=e.events.over||_default[this.cType].events.over,this.events.click=e.events.click||_default[this.cType].events.click,this.events.leave=e.events.leave||_default[this.cType].events.leave,this._sortData=e.sortData||_default[this.cType].sortData,this.style=e.style||_default[this.cType].style,this.colorScale=e.colorScale||_default[this.cType].colorScale,this.xAxisLabel=e.xaxis.label||_default[this.cType].xaxis.label,this.yAxisLabel=e.yaxis.label||_default[this.cType].yaxis.label;
}},{key:"_endAllTransitions",value:function(e,t){var n;e.empty()?t():(n=e.size(),e.each("end",function(){n--,0===n&&t()}))}},{key:"_removeUserEvents",value:function(){var e=["mousedown.user","mouseup.user","mouseleave.user","mouseover.user","click.user","mouseover.tip","mouseout.tip"];for(var t in e)this.interactiveElements.on(e[t],null)}},{key:"_updateXaxis",value:function(){this.svg.select(".x.axis").transition().duration(this.transitionDuration).call(this.xAxis)}},{key:"_updateYaxis",value:function(){this.svg.select(".y.axis").transition().duration(this.transitionDuration).call(this.yAxis)}},{key:"_updateAxis",value:function(){this._updateXaxis(),this._updateYaxis()}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function n(e,t,r){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:n(i,t,r)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(r)},SvgBarchartStrategy=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e));return n.xAxisName="x",n.yAxisName="y",n.x=d3.scale.ordinal().rangeRoundBands([0,n.width],.1),n.y=d3.scale.linear().range([n.height,0]),n.stack=d3.layout.stack(),n.isStacked=!1,n.xAxis=d3.svg.axis().scale(n.x).orient("bottom").ticks(10),n.yAxis=d3.svg.axis().scale(n.y).orient("left").innerTickSize(-n.width).outerTickSize(0).tickPadding(20).ticks(n.ticks,n.tickLabel),n.keyFunction=function(e){return e.x},n}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(e){var n=this;_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e),this.values=e.map(function(e){return e.values}),this.layers=this.stack(this.values),this.x.domain(this.layers[0].map(function(e){return e[n.xAxisName]}));var r=this.svg.selectAll(".layer").data(this.layers);r.enter().append("g").attr("class","layer").style("fill",function(e,t){return n.colorScale(t)}),r.exit().remove(),this._bars=r.selectAll("rect").data(function(e){return e}),this._bars.enter().append("rect").attr("x",function(e){return n.x(e.x)}).attr("y",function(e){return n.y(e.y+e.y0)}).attr("height",function(e){return n.y(e.y0)-n.y(e.y+e.y0)}).attr("width",this.x.rangeBand()-1),this._bars.exit().transition().duration(300).attr("y",this.y(0)).attr("height",this.height-this.y(0)).style("fill-opacity",1e-6).style().remove(),this.isStacked?this._transition2Stacked():this._transition2Grouped(),this._updateAxis(),this.interactiveElements=this._bars,this._applyCSS();var a=0;this.svg.selectAll(".x.axis g.tick text").each(function(){a+=this.getBBox().width}),a>this.width&&(this.xticks=null,this.xAxis.ticks(this.xticks),this.svg.selectAll("g.x.axis").call(this.xAxis))}},{key:"_transition2Stacked",value:function(){var e=this,t=d3.max(this.layers,function(e){return d3.max(e,function(e){return e.y0+e.y})});console.log("yStackMax",t);this.layers.length;this.y.domain([0,t]),this._bars.transition().duration(200).attr("y",function(t){return e.y(t.y0+t.y)}).attr("height",function(t){return e.y(t.y0)-e.y(t.y0+t.y)}).transition().attr("x",function(t){return e.x(t.x)}).attr("width",this.x.rangeBand()).call(this._endAllTransitions,function(){return e._barTransitionEnd(e._bars)}),this._updateYaxis(),this._applyCSS()}},{key:"_transition2Grouped",value:function(){var e=this,t=d3.max(this.layers,function(e){return d3.max(e,function(e){return e.y})}),n=this.layers.length;this.y.domain([0,t]),this._bars.transition().duration(200).attr("x",function(t,r,a){return e.x(t.x)+e.x.rangeBand()/n*a}).attr("width",this.x.rangeBand()/n).transition().attr("y",function(t){return e.y(t.y)}).attr("height",function(t){return e.height-e.y(t.y)}).call(this._endAllTransitions,function(){return e._barTransitionEnd(e._bars)}),this._updateYaxis(),this._applyCSS()}},{key:"_barTransitionEnd",value:function(e){e.on("mousedown.user",this.events.down).on("mouseup.user",this.events.up).on("mouseleave.user",this.events.leave).on("mouseover.user",this.events.over).on("click.user",this.events.click),this.tooltip&&e.on("mouseover.tip",this.tooltip.show).on("mouseout.tip",this.tooltip.hide)}},{key:"_initialize",value:function(){var e=this,n=null;_get(Object.getPrototypeOf(t.prototype),"_initialize",this).call(this),this.svg[0][0].addEventListener("transition",function(t){if(e._removeUserEvents(),n=t.detail.type,"grouped"===n)e._transition2Grouped();else{if("stacked"!==n)throw Error("Not recognized transition: "+n);e._transition2Stacked()}},!1),this._initialized=!0}},{key:"_loadConfigOnContext",value:function(e){return e=e||{events:{}},e.events||(e.events={}),_get(Object.getPrototypeOf(t.prototype),"_loadConfigOnContext",this).call(this,e),this}}]),t}(SvgChart),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function r(e,t,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:r(i,t,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},SvgLinechartStrategy=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e));switch(n.xAxisName="x",n.yAxisName="y",n.xDataType){case"Numeric":n.x=d3.scale.linear().range([0,n.width]),n.xAxis=d3.svg.axis().scale(n.x).orient("bottom").ticks(n.xticks);break;case"Date":n.x=d3.time.scale().range([0,n.width]),n.format=d3.time.format(n.xDateformat),n.xAxis=d3.svg.axis().scale(n.x).orient("bottom").ticks(n.xticks);break;default:n.x=d3.scale.linear().range([0,n.width]),n.xAxis=d3.svg.axis().scale(n.x).orient("bottom").ticks(n.xticks)}return n.y=d3.scale.linear().range([n.height,0]),n.yAxis=d3.svg.axis().scale(n.y).orient("left").innerTickSize(-n.width).outerTickSize(0).tickPadding(20).ticks(n.yticks,n.tickLabel),n.keyFunction=function(e){return e.x},n.seriesKeyFunction=function(e){return e.key},n}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(e){var n=this,r=null,a=null,i=this.format,o=null;if(_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e),"Date"===this.xDataType)for(o=0;o<e.length;o++)e[o].values.forEach(function(e){e.x=i.parse(e.x),e.y=+e.y});this.x.domain([d3.min(e,function(e){return d3.min(e.values,function(e){return e.x})}),d3.max(e,function(e){return d3.max(e.values,function(e){return e.x})})]),this.y.domain([0,d3.max(e,function(e){return d3.max(e.values,function(e){return e.y})})]),this.svg.select(".x.axis").transition().duration(this.transitionDuration).call(this.xAxis),this.svg.select(".y.axis").transition().duration(this.transitionDuration).call(this.yAxis),r=d3.svg.line().x(function(e){return n.x(e.x)}).y(function(e){return n.y(e.y)}),a=d3.svg.area().x(function(e){return n.x(e.x)}).y0(this.height).y1(function(e){return n.y(e.y)});var s=this.svg.selectAll(".series").data(e).enter().append("g").attr("class","series").style("stroke",function(e,t){return n.colorScale(t)}),l=s.append("path").attr("class","line"),c=s.append("path").attr("class","area"),u=this.svg.selectAll("path").data(e,this.seriesKeyFunction).style("stroke",function(e,t){return n.colorScale(t)}).style("fill",function(e,t){return n.colorScale(t)});if(this.area){var f=this.svg.selectAll(".area").data(e,this.seriesKeyFunction).style("stroke",function(e,t){return n.colorScale(t)}).style("fill",function(e,t){return n.colorScale(t)});c.attr("d",function(e){return a(e.values)}).style("stroke",function(e,t){return n.colorScale(t)}),f.style("fill-opacity",this.areaOpacity).attr("d",function(e){return a(e.values)})}if(l.attr("d",function(e){return r(e.values)}).style("stroke",function(e,t){return n.colorScale(t)}),u.attr("d",function(e){return r(e.values)}),this.markers){switch(this.markers.shape){case"circle":var h=this.svg.selectAll(".series").selectAll("circle").data(function(e,t){return e.values});h.enter().append("circle").attr("cx",function(e){return n.x(e.x)}).attr("cy",function(e){return n.y(e.y)}).attr("r",this.markers.size).style({fill:"white","stroke-width":this.markers.outlineWidth}),h.exit().remove(),h.transition().attr("cx",function(e){return n.x(e.x)}).attr("cy",function(e){return n.y(e.y)}).duration(0);break;default:throw Error("Not a valid marker shape: "+this.markers.shape)}this.tooltip&&h.on("mouseover.tip",this.tooltip.show).on("mouseout.tip",this.tooltip.hide),h.on("mousedown.user",this.events.down).on("mouseup.user",this.events.up).on("mouseleave.user",this.events.leave).on("mouseover.user",this.events.over).on("click.user",this.events.click),this.interactiveElements=h}this._applyCSS();var d=0;this.svg.selectAll(".x.axis g.tick text").each(function(){d+=this.getBBox().width}),d>this.width&&(this.xticks=null,this.xAxis.ticks(this.xticks),this.svg.selectAll("g.x.axis").call(this.xAxis))}},{key:"_initialize",value:function(){_get(Object.getPrototypeOf(t.prototype),"_initialize",this).call(this),this._initialized=!0}},{key:"_loadConfigOnContext",value:function(e){return _get(Object.getPrototypeOf(t.prototype),"_loadConfigOnContext",this).call(this,e),this.markers={},this.markers.color=e.markers.color||_default.Linechart.markers.color,this.markers.outlineColor=e.markers.outlineColor||_default.Linechart.markers.outlineColor,this.markers.outlineWidth=e.markers.outlineWidth||_default.Linechart.markers.outlineWidth,this.markers.shape=e.markers.shape||_default.Linechart.markers.shape,this.markers.size=e.markers.size||_default.Linechart.markers.size,this.area="undefined"==typeof e.area?_default.Linechart.area:e.area,this.areaOpacity=e.areaOpacity||_default.Linechart.areaOpacity,this.xDataType=e.xDataType||_default.Linechart.xDataType,this.xDateformat=e.xDateFormat||_default.Linechart.xDateFormat,this}}]),t}(SvgChart),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function a(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:a(i,t,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},SvgStreamgraphStrategy=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e));return n.x=d3.time.scale().range([0,n.width]),n.y=d3.scale.linear().range([n.height-10,0]),n.format=d3.time.format(n.xDateformat),n.xAxis=d3.svg.axis().scale(n.x).orient("bottom").ticks(d3.time.weeks),n.yAxis=d3.svg.axis().scale(n.y).orient("left").innerTickSize(-n.width).outerTickSize(0).tickPadding(20).ticks(n.ticks,n.tickLabel),n.keys=null,n}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(e){var t=this,n=null,r=null;if(this.keys){if(!this.keys.equals(utils.keys(e,"key")))return console.warn("Attemping to draw a streamgraph with a different set of keys after initialization. Skipping."),console.log(this.keys),void console.log(utils.keys(e,"key"))}else this.keys=utils.keys(e,"key");this._initialized||this._initialize(),e.forEach(function(e){e.date=t.format.parse(e.date),e.value=+e.value}),this.stack=d3.layout.stack().offset("silhouette").values(function(e){return e.values}).x(function(e){return e.date}).y(function(e){return e.value}),this.nest=d3.nest().key(function(e){return e.key}),this.area=d3.svg.area().interpolate("cardinal").x(function(e){return t.x(e.date)}).y0(function(e){return t.y(e.y0)}).y1(function(e){return t.y(e.y0+e.y)}),n=this.stack(this.nest.entries(e)),this.x.domain(d3.extent(e,function(e){return e.date})),this.y.domain([0,d3.max(e,function(e){return e.y0+e.y})]),r=utils.keys(e,"key").size,this.z=this.colorScale;var a=this.svg.selectAll(".series").data(n).enter().append("g").attr("class","series").style("stroke",function(e,n){return t.colorScale(n)});a.append("path");var i=this.svg.selectAll("path").data(n,function(e){return e.key});i.attr("class","layer").attr("d",function(e){return t.area(e.values)}).style("fill",function(e,n){return t.z(n)}),this.svg.selectAll(".layer").attr("opacity",1).on("mousedown.user",this.events.down).on("mouseup.user",this.events.up).on("mouseleave.user",this.events.leave).on("mouseover.user",this.events.over).on("click.user",this.events.click),this._updateAxis(),this.interactiveElements=this._layers,this._applyCSS()}},{key:"_initialize",value:function(){_get(Object.getPrototypeOf(t.prototype),"_initialize",this).call(this),this._initialized=!0}},{key:"_loadConfigOnContext",value:function(e){e=e||{events:{}},e.events||(e.events={}),_get(Object.getPrototypeOf(t.prototype),"_loadConfigOnContext",this).call(this,e),this.colorScale=e.colorScale||_default.Streamgraph.colorScale,this.xDateformat=e.xDateFormat||_default.Streamgraph.xDateFormat}}]),t}(SvgChart),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function i(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:i(a,t,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},SvgGaugeStrategy=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e));return n.scale=d3.scale.linear().domain([n.minLevel,n.maxLevel]).range([0,1]),n.angleScale=d3.scale.linear().domain([n.minLevel,n.maxLevel]).range([90+n.minAngle,90+n.maxAngle]),n.colorScale.domain([0,1]),n.scaleMarks=n.scale.ticks(n.ticks),n.tickData=d3.range(n.ticks).map(function(){return 1/n.ticks}),n.keyFunction=function(e){return e.x},n.translation=function(){return"translate("+n.r+","+n.r+")"},n}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(e){var n=this,r=null;_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e),this.datum=e[e.length-1],r=this.needleLenghtRatio*this.r,this.needle||(this.needle=this.svg.append("path").attr("class","needle").datum(this.datum.x).attr("transform",function(e){return"translate("+n.r+", "+n.r+") rotate("+(n.angleScale(e)-90)+")"}).attr("d","M "+(0-this.needleNutRadius)+" 0 L 0 "+(0-r)+" L "+this.needleNutRadius+" 0")),this.needle.transition().attr("transform",function(e){return"translate("+n.r+", "+n.r+") rotate("+(n.angleScale(n.datum.x)-90)+")"}).attr("d","M "+(0-this.needleNutRadius)+" 0 L 0 "+(0-r)+" L "+this.needleNutRadius+" 0"),this.svg.select(".text-indicator").text(this.datum.x),this._applyCSS()}},{key:"_initialize",value:function(){var e=this,t=this.width+this.margin.left+this.margin.right,n=this.height+this.margin.left+this.margin.right,r=null,a=null;this.svg=d3.select(this.selector).append("svg").attr({width:t,height:n}).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.range=this.maxAngle-this.minAngle,this.r=this.width/2,this.needleLength=Math.round(this.r*this.needleLenghtRatio),this.arc=d3.svg.arc().innerRadius(this.r-this.ringWidth-this.ringMargin).outerRadius(this.r-this.ringMargin).startAngle(function(t,n){var r=t*n;return utils.deg2rad(e.minAngle+r*e.range)}).endAngle(function(t,n){var r=t*(n+1);return utils.deg2rad(e.minAngle+r*e.range)}),a=this.svg.append("g").attr("class","arc").attr("transform",this.translation);var i=a.selectAll("path").data(this.tickData).enter().append("path").attr("id",function(e,t){return"sector-"+t}).attr("d",this.arc);this.invertColorScale?i.attr("fill",function(t,n){return e.colorScale(1-t*n)}):i.attr("fill",function(t,n){return e.colorScale(t*n)}),r=this.svg.append("g").attr("class","labels").attr("transform",this.translation),r.selectAll("text").data(this.scaleMarks).enter().append("text").attr("transform",function(t){var n=e.scale(t),r=e.minAngle+n*e.range;return"rotate("+r+") translate(0,"+(e.labelInset-e.r)+")"}).text(function(e){return e}),this.svg.append("circle").attr("class","needle").attr("transform",this.translation).attr("cx",0).attr("cy",0).attr("r",this.needleNutRadius),this.svg.append("g").attr("class","needle"),this.numericIndicator&&this.svg.append("text").attr("class","text-indicator").attr("transform",this.translation).attr("x",0).attr("y",100).text("0"),this._initialized=!0}},{key:"_loadConfigOnContext",value:function(e){return _get(Object.getPrototypeOf(t.prototype),"_loadConfigOnContext",this).call(this,e),this.minLevel=e.minLevel||_default.Gauge.minLevel,this.maxLevel=e.maxLevel||_default.Gauge.maxLevel,this.minAngle=e.minAngle||_default.Gauge.minAngle,this.maxAngle=e.maxAngle||_default.Gauge.maxAngle,this.ticks=e.ticks||_default.Gauge.ticks,this.ringWidth=e.ringWidth||_default.Gauge.ringWidth,this.ringMargin=e.ringMargin||_default.Gauge.ringMargin,this.labelInset=e.labelInset||_default.Gauge.labelInset,this.needleNutRadius=e.needleNutRadius||_default.Gauge.needleNutRadius,this.needleLenghtRatio=e.needleLenghtRatio||_default.Gauge.needleLenghtRatio,this.invertColorScale="undefined"==typeof e.invertColorScale?_default.Gauge.invertColorScale:e.invertColorScale,this.numericIndicator="undefined"==typeof e.numericIndicator?_default.Gauge.numericIndicator:e.numericIndicator,this}}]),t}(SvgChart),_get=function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:o(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Chart=function(){function e(){_classCallCheck(this,e);var t=this.constructor.name;if("Chart"===t||"Basic"===t||"Flow"===t)throw new Error(t+" is non-instanciable");this.events={},e.prototype.custom=new Object;var n=[];for(var r in _default[this.constructor.name])n.push(r);n.forEach(function(t){e.prototype.custom[t]=function(e){return console.debug("changing property",t,"to",e,this),this}})}return _createClass(e,[{key:"_getChartContext",value:function(){return{data:this.data,config:this.config,cType:this.constructor.name}}},{key:"_initializeSVGContext",value:function(){this._svg=new SvgStrategy(strategies[this.constructor.name](this._getChartContext()))}},{key:"addPoint",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(!e||!utils.isObject(e))throw Error("'point' should be an object. Instead: "+e);this.data.push(e),t&&this.draw()}},{key:"addPoints",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(!e||e.constructor!==Array)throw Error("'points' should be an array. Instead: "+e);this.data=this.data.concat(e),t&&this.draw()}},{key:"removePoint",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(!e||!utils.isObject(e))throw Error("'point' should be an object. Instead: "+e);this.data.some(function(n,r,a){var i=JSON.stringify(n)===JSON.stringify(e);return i?t.data.splice(r,1):void 0}),n&&this.draw()}},{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.data:arguments[0];if(!utils.isArray(e))throw new TypeError("draw method is only allowed with static data.");e=JSON.parse(JSON.stringify(e)),this._svg.draw(e)}},{key:"toPNG",value:function(e){utils.svgAsDataUri(d3.select(this.config.selector+" svg")[0][0],{},function(t,n){if(n)throw Error("Error converting to image "+n);e(t)})}},{key:"on",value:function(e,t){if(!e||"string"!=typeof e)throw Error("eventName should be a string. Instead: "+e);if(!t||!utils.isFunction(t))throw Error("action should be a function. Instead: "+e);return this.events[e]=t,this._svg.on(this.events),this}},{key:"_configureDatasource",value:function(){var e=this;this.datasource.configure(this.reactor),this.reactor.registerEvent("onmessage"),this.reactor.registerEvent("onerror"),this.reactor.registerEvent("onopen"),this.reactor.addEventListener("onmessage",function(t){e.keepDrawing(t)}),this.reactor.addEventListener("onopen",function(e){console.debug("Connected to websocket endpoint.",e)}),this.reactor.addEventListener("onerror",function(e){console.error("An error has occured: ",e)})}},{key:"pause",value:function(){if(!this.datasource)throw"You need a datasource to pause a streaming";this.reactor.removeEventListener("onmessage")}},{key:"resume",value:function(){var e=this;if(!this.datasource)throw"You need a datasource to resume a streaming";this.reactor.addEventListener("onmessage",function(t){e.keepDrawing(t)})}}]),e}(),Basic=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e.reactor=new Reactor,e}return _inherits(t,e),_createClass(t,[{key:"keepDrawing",value:function(e){var t=this.config;t.maxNumberOfElements;if(!e)return void console.warn("attemp to draw null datum");if("Array"===e.constructor.name)for(var n in e)this.keepDrawing(e[n]);else{var r=utils.findElement(this.data,"key",e.key);r&&r.values||(r={key:e.key,values:[]},this.data.push(r)),r.values=r.values.concat(e.values)}return this.draw(this.data),this.data}}]),t}(Chart),Flow=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(e){e=JSON.parse(JSON.stringify(e)),_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}}]),t}(Chart),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function s(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:s(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},Barchart=function(e){function t(e,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));if(!arguments.length)throw new Error("Missing constructor parameters");var a=arguments[0].constructor.name,i=arguments.length;switch(a){case"WebsocketDatasource":r.datasource=arguments[0],r.data=[],r._configureDatasource();break;case"Array":r.data=arguments[0];break;default:throw TypeError("Wrong data format")}return r.config=1==i?_default[r.constructor.name]:arguments[1],r._initializeSVGContext(),r}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.data:arguments[0];_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}},{key:"fire",value:function(e,t){var n=this._svg.strategy.svg;if(!n||!n[0][0])throw Error("Cannot fire events because SVG dom element is not yet initialized");n[0][0].dispatchEvent(new CustomEvent(e,{detail:{type:t}}))}},{key:"keepDrawing",value:function(e){_get(Object.getPrototypeOf(t.prototype),"keepDrawing",this).call(this,e)}}]),t}(Basic),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function l(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:l(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},Linechart=function(e){function t(e,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));if(!arguments.length)throw new Error("Missing constructor parameters");var a=arguments[0].constructor.name,i=arguments.length;switch(a){case"WebsocketDatasource":r.datasource=arguments[0],r.data=[],r._configureDatasource();break;case"Array":r.data=arguments[0];break;default:throw TypeError("Wrong data format")}return r.config=1==i?_default[r.constructor.name]:arguments[1],r._initializeSVGContext(),r}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.data:arguments[0];_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}},{key:"keepDrawing",value:function(e){return _get(Object.getPrototypeOf(t.prototype),"keepDrawing",this).call(this,e)}}]),t}(Basic),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function c(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:c(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},Streamgraph=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));if(!arguments.length)throw new Error("Missing constructor parameters");var n=arguments[0].constructor.name,r=arguments.length;switch(n){case"WebsocketDatasource":e.datasource=arguments[0],e.data=[],e._configureDatasource();break;case"Array":e.data=arguments[0];break;default:throw TypeError("Wrong data format")}return e.config=1==r?_default[e.constructor.name]:arguments[1],e._initializeSVGContext(),e}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.data:arguments[0];_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}},{key:"keepDrawing",value:function(e){this.datum||(this.datum=[]),this.datum=this.datum.concat(e),_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,this.datum)}}]),t}(Flow),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function u(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:u(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},Gauge=function(e){function t(e,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));if(!arguments.length)throw new Error("Missing constructor parameters");var a=arguments[0].constructor.name,i=arguments.length;switch(a){case"WebsocketDatasource":r.datasource=arguments[0],r.data=[],r._configureDatasource();break;case"Array":r.data=arguments[0];break;default:throw TypeError("Wrong data format")}return r.config=1===i?_default[r.constructor.name]:arguments[1],r._initializeSVGContext(),r}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.data:arguments[0];_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}},{key:"fire",value:function(e,t){var n=this._svg.strategy.svg;if(!n||!n[0][0])throw Error("Cannot fire events because SVG dom element is not yet initialized");n[0][0].dispatchEvent(new CustomEvent(e,{detail:{type:t}}))}},{key:"keepDrawing",value:function(e){var n=this.config,r=n.maxNumberOfElements;if(this.datum||(this.datum=[]),this.datum=this.datum.concat(e),r&&r>0&&this.datum.length>r)for(var a=0;a<e.length;a++)this.datum.shift();_get(Object.getPrototypeOf(t.prototype),"draw",this).call(this,this.datum)}}]),t}(Basic);!function(){window.ProteusFactory={create:function(e){switch(e.type){case"Linechart":return new Linechart(e.data,e.config);case"Barchart":return new Barchart(e.data,e.config);case"Gauge":return new Gauge(e.data,e.config);case"Streamgraph":return new Streamgraph(e.data,e.config);default:throw TypeError("Unknow chart type"+e.type)}}}}();